<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Meu Portf√≥lio de Responsa üöÄ</title>
    <!-- Biblioteca para gerar imagem do card -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #4d79ff; /* Azul El√©trico */
            --primary-dark: #0033cc;
            --secondary: #ffaa00; /* Laranja Pop */
            --accent: #00e676; /* Verde Neon */
            --bg-color: #ffde59; /* Amarelo Sol */
            --card-bg: #ffffff;
            --text: #2c3e50;
            --error: #ff4444;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --shadow-color: #000000;
            --radius-main: 25px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            background-image: radial-gradient(#ffbd59 20%, transparent 20%),
                              radial-gradient(#ffbd59 20%, transparent 20%);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text);
        }

        /* Bot√µes Reset */
        button {
            font-family: inherit;
            border: none;
            cursor: pointer;
            background: none;
        }

        .game-container {
            background: var(--card-bg);
            width: 95%;
            max-width: 600px;
            border-radius: var(--radius-main);
            border: 4px solid var(--shadow-color); /* Borda grossa estilo HQ */
            box-shadow: 10px 10px 0px var(--shadow-color); /* Sombra dura */
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s;
            margin: 20px auto;
            max-height: 95vh;
        }

        .header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            text-align: center;
            position: relative;
            border-bottom: 4px solid var(--shadow-color);
            flex-shrink: 0;
        }

        .stage-title {
            font-size: 1.4rem;
            font-weight: 900;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 2px 2px 0px var(--shadow-color);
        }

        .progress-container {
            background: rgba(0,0,0,0.3);
            height: 12px;
            border-radius: 6px;
            margin-top: 10px;
            width: 100%;
            border: 2px solid white;
            overflow: hidden;
        }

        .progress-bar {
            background: var(--accent);
            height: 100%;
            width: 0%;
            transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
            background-size: 1rem 1rem;
        }

        .content-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 0;
            position: relative;
            background: #fff;
        }

        .screen {
            padding: 25px 30px;
            display: none;
            flex-direction: column;
            gap: 15px;
            animation: fadeIn 0.4s ease;
        }

        .screen.active {
            display: flex;
        }

        h2 { font-size: 1.6rem; margin-bottom: 0.5rem; color: var(--text); font-weight: 800; }
        h3 { font-size: 1.3rem; color: var(--primary-dark); margin: 0; font-weight: 800; }
        p { line-height: 1.5; font-size: 1rem; margin-bottom: 10px; color: #444; }

        label {
            font-weight: 800;
            color: var(--primary-dark);
            font-size: 0.95rem;
            margin-bottom: 5px;
            display: block;
            margin-top: 15px;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 3px solid #ccc; /* Bordas mais grossas */
            border-radius: 12px;
            font-family: inherit;
            background: #fdfdfd;
            font-size: 16px;
            color: #333;
            transition: all 0.2s;
        }

        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            box-shadow: 4px 4px 0px rgba(77, 121, 255, 0.2);
            outline: none;
            transform: translateY(-2px);
        }

        /* Estilos de Erro (Valida√ß√£o Visual) */
        .input-error {
            border-color: var(--error) !important;
            background-color: #fff8f8;
            animation: shake 0.3s;
        }

        .error-message {
            color: var(--error);
            font-size: 0.8rem;
            margin-top: 4px;
            display: none;
            font-weight: bold;
        }

        .helper-text {
            font-size: 0.85rem;
            color: #555;
            background: #eee;
            padding: 8px 12px;
            border-radius: 0 0 10px 10px;
            margin-top: -5px;
            border-left: none; /* Remove a barra lateral do estilo clean */
            border-top: none;
            font-weight: 500;
        }

        /* Upload de Foto Customizado */
        .photo-upload-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
            padding: 10px;
            border: 3px dashed #ccc;
            border-radius: 12px;
            background: #fafafa;
        }

        .photo-preview-small {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #eee;
            object-fit: cover;
            border: 2px solid var(--text);
        }

        .btn-upload {
            background: var(--text);
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: bold;
            display: inline-block;
            cursor: pointer;
            box-shadow: 3px 3px 0px rgba(0,0,0,0.2);
        }

        .btn-example {
            background: #f0f4f8;
            border: 2px dashed var(--primary);
            color: var(--primary);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 8px;
            width: 100%;
            text-align: center;
            transition: all 0.2s;
        }
        
        .btn-example:hover {
            background: var(--primary);
            color: white;
            border-style: solid;
        }

        .inspiration-box {
            display: none;
            background: #fff8e1;
            border: 2px solid #ffca28;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #5d4037;
            box-shadow: 4px 4px 0px rgba(255, 202, 40, 0.3);
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tag-btn {
            background: white;
            border: 2px solid #ccc;
            padding: 12px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: bold;
            color: #555;
            flex-grow: 1;
            text-align: center;
            transition: all 0.2s;
        }

        .tag-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .tag-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
            box-shadow: 3px 3px 0px var(--shadow-color);
            transform: translate(-2px, -2px);
        }

        /* Navega√ß√£o */
        .nav-buttons {
            padding: 15px 20px;
            background: #f9f9f9;
            display: flex;
            justify-content: space-between;
            border-top: 4px solid var(--shadow-color);
            flex-shrink: 0;
            gap: 10px;
        }

        .btn {
            padding: 15px 20px;
            border-radius: 12px;
            border: 3px solid var(--shadow-color);
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            font-size: 1rem;
            flex: 1;
            transition: transform 0.1s;
        }
        
        .btn:active { transform: translate(3px, 3px); box-shadow: none !important; }

        .btn-prev { background: #fff; color: var(--text); box-shadow: 4px 4px 0px #ccc; }
        .btn-next { background: var(--secondary); color: var(--text); box-shadow: 4px 4px 0px var(--shadow-color); }
        .btn-download { background: var(--accent); color: var(--text); border-color: var(--text); width: 100%; box-shadow: 4px 4px 0px var(--shadow-color); }

        /* Card Final */
        .portfolio-card {
            border: 3px solid var(--text);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 10px;
            background: white;
            box-shadow: 6px 6px 0px rgba(0,0,0,0.1);
        }
        
        .card-body { padding: 20px; }

        .portfolio-header {
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 3px dashed #ddd;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .avatar-placeholder {
            width: 70px; height: 70px;
            font-size: 35px;
            background: #ffe082;
            border: 3px solid var(--text);
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            flex-shrink: 0;
            overflow: hidden; /* Para imagem real */
        }

        .avatar-img-real {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .section-title {
            background: var(--text);
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 6px;
            display: inline-block;
            margin-top: 12px;
            text-transform: uppercase;
        }

        .section-content {
            font-size: 0.95rem;
            background: #f4f6f8;
            padding: 12px;
            border-radius: 8px;
            border-left: 5px solid var(--secondary);
            margin-top: 8px;
            word-wrap: break-word;
        }

        .tip-box {
            background: #fff8e1;
            border: 3px solid var(--secondary);
            border-radius: 12px;
            padding: 15px;
            font-size: 0.95rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 5px 5px 0px rgba(255, 170, 0, 0.2);
        }

        @media (min-width: 768px) {
            .game-container {
                margin: 40px auto;
                box-shadow: 15px 15px 0px var(--shadow-color);
            }
            .screen { padding: 40px; }
            h2 { font-size: 2rem; }
            .tag-btn { flex-grow: 0; }
            .btn { flex: 0 0 auto; min-width: 150px; }
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

    </style>
</head>
<body>

<div class="game-container">
    <div class="header">
        <h2 class="stage-title" id="page-title">In√≠cio</h2>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>

    <!-- √Årea de Conte√∫do -->
    <div class="content-area" id="main-content">
        
        <!-- TELA 1: INTRO -->
        <div class="screen active" id="step-1">
            <div style="text-align: center;">
                <div style="font-size: 60px; margin-bottom: 10px; animation: slideUp 1s infinite alternate;">üëãüòä</div>
                <h2 style="color: var(--primary-dark);">Sua Marca no Trabalho</h2>
                <p>Ol√°, Jovem Aprendiz! üåü</p>
                <p>Voc√™ j√° est√° contratado, parab√©ns! O desafio agora √© construir sua carreira dentro da empresa.</p>
                <p>Vamos criar seu <strong>Card Profissional</strong> para voc√™ ter clareza de onde quer chegar. Seus dados ficam salvos automaticamente!</p>
                <div class="tip-box">
                    <span style="font-size: 2rem;">üí°</span>
                    <span><strong>Dica do CIEE:</strong> Sua "Marca Pessoal" √© constru√≠da todo dia. Vamos nessa!</span>
                </div>
            </div>
        </div>

        <!-- TELA 2: APRESENTA√á√ÉO (PERFIL) -->
        <div class="screen" id="step-2">
            <h3>1. Quem √© voc√™? üÜî</h3>
            
            <label for="inp-name">Nome Completo (ou Social) *</label>
            <input type="text" id="inp-name" placeholder="Ex: Jo√£o da Silva">
            <div class="error-message" id="err-name">Este campo √© obrigat√≥rio.</div>
            <p class="helper-text">Use o nome pelo qual voc√™ √© conhecido na empresa.</p>

            <label for="inp-location">Idade & Bairro *</label>
            <input type="text" id="inp-location" placeholder="Ex: 17 anos, Madureira - RJ">
            <div class="error-message" id="err-location">Este campo √© obrigat√≥rio.</div>
            
            <label>Foto de Perfil (Opcional)</label>
            <div class="photo-upload-container">
                <img id="preview-mini" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI2NjYyI+PHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYy04LTIuNjYtOC00LTgtNHoiLz48L3N2Zz4=" class="photo-preview-small" alt="Pr√©via">
                <label for="inp-photo" class="btn-upload">üì∑ Escolher Foto</label>
                <input type="file" id="inp-photo" accept="image/*" style="display:none">
            </div>
            <p class="helper-text">Se n√£o escolher, usaremos um avatar divertido.</p>
            
            <label for="inp-bio">Sobre Mim (Como profissional) *</label>
            <textarea id="inp-bio" rows="3" placeholder="Escreva aqui suas qualidades..."></textarea>
            <div class="error-message" id="err-bio">Este campo √© obrigat√≥rio.</div>
            
            <button type="button" class="btn-example" onclick="showExample('bio')">üé≤ Sortear um exemplo para inspira√ß√£o</button>
            <div id="bio-example-box" class="inspiration-box"></div>
        </div>

        <!-- TELA 3: OBJETIVOS (MISS√ÉO) -->
        <div class="screen" id="step-3">
            <h3>2. Qual seu pr√≥ximo passo? üéØ</h3>
            
            <label for="inp-objective-select">Meu foco atual na empresa √©: *</label>
            <select id="inp-objective-select">
                <option value="">Selecione...</option>
                <option value="efetivacao">Ser efetivado ao final do contrato</option>
                <option value="conhecimento">Aprender o m√°ximo sobre a √°rea que atuo</option>
                <option value="networking">Conhecer profissionais e fazer contatos</option>
                <option value="rotina">Entender como funciona o mundo corporativo</option>
            </select>
            <div class="error-message" id="err-objective">Por favor, selecione uma op√ß√£o.</div>

            <label for="inp-objective-custom">√Årea de Interesse (Opcional):</label>
            <input type="text" id="inp-objective-custom" placeholder="Ex: Financeiro, RH, Marketing...">
        </div>

        <!-- TELA 4: HABILIDADES -->
        <div class="screen" id="step-4">
            <h3>3. Seus Pontos Fortes üí™</h3>
            <p class="helper-text">Selecione pelo menos 3 qualidades que voc√™ tem.</p>

            <div class="tags-container" id="skills-container">
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Comunica√ß√£o üó£Ô∏è</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Trabalho em Equipe ü§ù</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Proatividade (Iniciativa) ‚ö°</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Criatividade üé®</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Pontualidade ‚è∞</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Vontade de Aprender üìö</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Organiza√ß√£o üóÇÔ∏è</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Inform√°tica B√°sica üíª</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Resili√™ncia üõ°Ô∏è</button>
                <button type="button" class="tag-btn" onclick="toggleSkill(this)">Empatia ‚ù§Ô∏è</button>
            </div>
            <div class="error-message" id="err-skills">Selecione pelo menos 3 habilidades.</div>

            <label for="inp-skill-custom">Outra Habilidade (Opcional):</label>
            <input type="text" id="inp-skill-custom" placeholder="Ex: Excel, Ingl√™s...">
        </div>

        <!-- TELA 5: EXPERI√äNCIAS -->
        <div class="screen" id="step-5">
            <h3>4. Minha Caminhada üéí</h3>
            
            <label for="inp-school">Escolaridade *</label>
            <input type="text" id="inp-school" placeholder="Ex: Cursando 2¬∫ ano do Ensino M√©dio...">
            <div class="error-message" id="err-school">Este campo √© obrigat√≥rio.</div>
            
            <label for="inp-courses">Cursos / Oficinas (Opcional)</label>
            <input type="text" id="inp-courses" placeholder="Ex: Oficina Qual a Sua Marca? - CIEE">
            <!-- Campo opcional, sem mensagem de erro -->

            <label for="inp-extra">Viv√™ncias e Projetos (O que eu j√° fiz) *</label>
            <textarea id="inp-extra" rows="2" placeholder="Digite aqui..."></textarea>
            <div class="error-message" id="err-extra">Este campo √© obrigat√≥rio.</div>
            
            <button type="button" class="btn-example" onclick="showExample('extra')">üé≤ Sortear um exemplo para inspira√ß√£o</button>
            <div id="extra-example-box" class="inspiration-box"></div>
            
            <p class="helper-text">N√£o precisa ser carteira assinada! Vale voluntariado, ajudar no neg√≥cio da fam√≠lia, projetos da escola...</p>
        </div>

        <!-- TELA 6: RESULTADO -->
        <div class="screen" id="step-6">
            <div style="text-align: center;">
                <div style="font-size: 50px;">‚ú®</div>
                <h3 style="color: var(--primary-dark); margin: 5px 0;">Card Criado!</h3>
                <p style="margin: 0; font-size: 0.9rem;">Resumo da sua marca atual.</p>
            </div>

            <div class="portfolio-card" id="final-card">
                <div class="card-top-deco" style="height: 15px; background: repeating-linear-gradient(45deg, var(--primary), var(--primary) 10px, var(--primary-dark) 10px, var(--primary-dark) 20px);"></div>
                <div class="card-body">
                    <div class="portfolio-header">
                        <div class="avatar-placeholder" id="res-avatar">üòé</div>
                        <div>
                            <h2 style="margin:0; font-size: 1.4rem; color: var(--text); text-transform: uppercase; font-weight: 900;" id="res-name">Nome</h2>
                            <span style="font-size: 1rem; color: #666; font-weight: bold;" id="res-location">Local</span>
                        </div>
                    </div>

                    <div class="section-title">üéØ Objetivo</div>
                    <div class="section-content" id="res-objective">...</div>

                    <div class="section-title">‚ö° Habilidades</div>
                    <div class="section-content" id="res-skills">...</div>

                    <div class="section-title">üéí Minha Jornada</div>
                    <div class="section-content" id="res-xp">...</div>
                </div>
            </div>

            <div style="margin-top: 15px;">
                 <button type="button" class="btn btn-download" onclick="downloadCard()">üì∏ BAIXAR CARD COMO IMAGEM</button>
                 
                 <p style="font-size: 0.8rem; color: #444; margin-top: 10px; text-align: center; font-weight: bold;">Salve este card para usar no seu PDI!</p>
            </div>

            <div style="background: #2c3e50; color: #f1c40f; padding: 20px; border-radius: 12px; margin-top: 25px; border: 3px solid #f1c40f; box-shadow: 5px 5px 0px rgba(0,0,0,0.2);">
                <div style="text-align: center; font-weight: 900; margin-bottom: 10px; border-bottom: 2px dashed #f1c40f; padding-bottom: 8px; font-size: 1.1rem;">‚≠ê DICAS PARA SE DESTACAR ‚≠ê</div>
                <div id="tips-container"></div>
            </div>
        </div>

    </div>

    <!-- Navega√ß√£o Fixa Embaixo -->
    <div class="nav-buttons">
        <button type="button" class="btn btn-prev" id="btn-prev" onclick="changeStep(-1)">Voltar</button>
        <button type="button" class="btn btn-next" id="btn-next" onclick="changeStep(1)">Pr√≥ximo >></button>
    </div>
</div>

<script>
    let currentStep = 1;
    const totalSteps = 6;
    const titles = ["Boas-vindas", "Seu Perfil", "Seu Foco", "Pontos Fortes", "Sua Bagagem", "Resultado Final"];
    let userPhotoURL = null;

    // --- LOCAL STORAGE ---
    const STORAGE_KEY = 'portfolio_responsa_data';

    function loadState() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
            const data = JSON.parse(saved);
            
            document.getElementById('inp-name').value = data.name || '';
            document.getElementById('inp-location').value = data.location || '';
            document.getElementById('inp-bio').value = data.bio || '';
            document.getElementById('inp-objective-select').value = data.objectiveSelect || '';
            document.getElementById('inp-objective-custom').value = data.objectiveCustom || '';
            document.getElementById('inp-skill-custom').value = data.skillCustom || '';
            document.getElementById('inp-school').value = data.school || '';
            document.getElementById('inp-courses').value = data.courses || '';
            document.getElementById('inp-extra').value = data.extra || '';

            if (data.skills) {
                const buttons = document.querySelectorAll('.tag-btn');
                buttons.forEach(btn => {
                    if (data.skills.includes(btn.innerText)) {
                        btn.classList.add('selected');
                    }
                });
            }
        }
    }

    function saveState() {
        let selectedSkills = [];
        document.querySelectorAll('.tag-btn.selected').forEach(btn => selectedSkills.push(btn.innerText));

        const data = {
            name: document.getElementById('inp-name').value,
            location: document.getElementById('inp-location').value,
            bio: document.getElementById('inp-bio').value,
            objectiveSelect: document.getElementById('inp-objective-select').value,
            objectiveCustom: document.getElementById('inp-objective-custom').value,
            skillCustom: document.getElementById('inp-skill-custom').value,
            school: document.getElementById('inp-school').value,
            courses: document.getElementById('inp-courses').value,
            extra: document.getElementById('inp-extra').value,
            skills: selectedSkills
        };

        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    document.querySelectorAll('input, textarea, select').forEach(el => {
        el.addEventListener('input', saveState);
    });

    // --- UPLOAD DE FOTO ---
    document.getElementById('inp-photo').addEventListener('change', function(e) {
        if (this.files && this.files[0]) {
            userPhotoURL = URL.createObjectURL(this.files[0]);
            document.getElementById('preview-mini').src = userPhotoURL;
        }
    });

    // --- EXEMPLOS ---
    const examples = {
        bio: [
            "Sou organizado, pontual e tenho muita vontade de aprender as rotinas do setor.",
            "Gosto de trabalhar em equipe e estou sempre dispon√≠vel para ajudar nas tarefas do dia a dia.",
            "Tenho facilidade com tecnologia e busco sempre agilizar as entregas com qualidade.",
            "Sou comunicativo, atencioso no atendimento e quero crescer junto com a equipe."
        ],
        extra: [
            "Na escola, sempre fui l√≠der de grupo nos trabalhos, organizando as tarefas de cada um.",
            "Participo de a√ß√µes volunt√°rias no meu bairro, o que me ensinou a lidar com pessoas diferentes.",
            "Ajudo na organiza√ß√£o das contas de casa, desenvolvendo no√ß√£o de responsabilidade financeira.",
            "Fiz cursos de inform√°tica b√°sica antes de entrar na empresa e uso isso nas planilhas."
        ]
    };

    function showExample(type) {
        const boxId = type === 'bio' ? 'bio-example-box' : 'extra-example-box';
        const box = document.getElementById(boxId);
        const list = examples[type];
        const randomText = list[Math.floor(Math.random() * list.length)];
        box.innerText = randomText;
        box.style.display = 'block';
    }

    // --- NAVEGA√á√ÉO E VALIDA√á√ÉO ---
    function updateUI() {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(`step-${currentStep}`).classList.add('active');
        document.getElementById('page-title').innerText = titles[currentStep - 1];

        const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;

        const btnPrev = document.getElementById('btn-prev');
        const btnNext = document.getElementById('btn-next');

        btnPrev.style.visibility = (currentStep === 1) ? 'hidden' : 'visible';

        if (currentStep === totalSteps) {
            btnNext.style.display = 'none';
            generatePortfolio();
        } else {
            btnNext.style.display = 'block';
            btnNext.innerText = (currentStep === totalSteps - 1) ? "GERAR CARD ‚ú®" : "Pr√≥ximo >>";
        }
        
        document.getElementById('main-content').scrollTop = 0;
    }

    function showError(elementId, show) {
        const el = document.getElementById(elementId.replace('err-', 'inp-'));
        const errMsg = document.getElementById(elementId);
        if (show) {
            if(el) el.classList.add('input-error');
            errMsg.style.display = 'block';
        } else {
            if(el) el.classList.remove('input-error');
            errMsg.style.display = 'none';
        }
    }

    function validateStep(step) {
        let valid = true;
        
        // Limpa erros
        document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
        document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');

        if (step === 2) {
            const nameVal = document.getElementById('inp-name').value.trim();
            const locationVal = document.getElementById('inp-location').value.trim();
            const bioVal = document.getElementById('inp-bio').value.trim();
            
            if (!nameVal) { showError('err-name', true); valid = false; }
            if (!locationVal) { showError('err-location', true); valid = false; }
            if (!bioVal) { showError('err-bio', true); valid = false; }
        }

        if (step === 3) {
            const objectiveVal = document.getElementById('inp-objective-select').value;
            if (!objectiveVal) { showError('err-objective', true); valid = false; }
        }

        if (step === 4) {
            const selected = document.querySelectorAll('.tag-btn.selected').length;
            if (selected < 3) {
                document.getElementById('err-skills').style.display = 'block';
                valid = false;
            }
        }

        if (step === 5) {
            const schoolVal = document.getElementById('inp-school').value.trim();
            // coursesVal removido da valida√ß√£o obrigat√≥ria
            const extraVal = document.getElementById('inp-extra').value.trim();

            if (!schoolVal) { showError('err-school', true); valid = false; }
            // Valida√ß√£o de cursos removida
            if (!extraVal) { showError('err-extra', true); valid = false; }
        }
        
        return valid;
    }

    function changeStep(direction) {
        if (direction === 1) {
            if (!validateStep(currentStep)) return;
        }
        
        currentStep += direction;
        if (currentStep < 1) currentStep = 1;
        if (currentStep > totalSteps) currentStep = totalSteps;
        updateUI();
    }

    function toggleSkill(btn) {
        btn.classList.toggle('selected');
        saveState();
    }

    // --- GERA√á√ÉO FINAL ---
    function generatePortfolio() {
        const name = document.getElementById('inp-name').value || "Jovem Aprendiz";
        const location = document.getElementById('inp-location').value || "Rio de Janeiro";
        const bio = document.getElementById('inp-bio').value;
        const objectiveSelect = document.getElementById('inp-objective-select');
        const objectiveText = objectiveSelect.options[objectiveSelect.selectedIndex].text;
        const objectiveValue = objectiveSelect.value;
        const objectiveCustom = document.getElementById('inp-objective-custom').value;
        const school = document.getElementById('inp-school').value;
        const courses = document.getElementById('inp-courses').value;
        const extra = document.getElementById('inp-extra').value;
        const customSkill = document.getElementById('inp-skill-custom').value;

        // Avatar
        const avatarEl = document.getElementById('res-avatar');
        avatarEl.innerHTML = ''; 
        
        if (userPhotoURL) {
            const img = document.createElement('img');
            img.src = userPhotoURL;
            img.className = 'avatar-img-real';
            avatarEl.appendChild(img);
        } else {
            const avatars = ["üòé", "üòä", "üöÄ", "üåü", "üí°", "üéì", "‚ö°", "üß¢"];
            avatarEl.innerText = avatars[Math.floor(Math.random() * avatars.length)];
        }

        // Skills
        let skills = [];
        document.querySelectorAll('.tag-btn.selected').forEach(btn => skills.push(btn.innerText));
        if (customSkill) skills.push(customSkill);
        
        // Preenchimento
        document.getElementById('res-name').innerText = name;
        document.getElementById('res-location').innerText = location;
        
        let finalObjective = (objectiveValue) ? objectiveText : "Aprender e crescer na empresa.";
        if (objectiveCustom) finalObjective += ` | Interesse em: ${objectiveCustom}`;
        document.getElementById('res-objective').innerText = finalObjective;

        document.getElementById('res-skills').innerText = skills.join(" ‚Ä¢ ");

        let xpText = `üè´ ${school || "Estudante"}`;
        if (courses) xpText += `\nüéì ${courses}`;
        if (extra) xpText += `\nüíº ${extra}`;
        if (bio) xpText += `\n\nüí¨ Perfil: ${bio}`;
        document.getElementById('res-xp').innerText = xpText;

        // DICAS
        generateTips(objectiveValue, skills, extra);
    }

    function generateTips(objectiveType, skillsArray, extraExperience) {
        const tipsContainer = document.getElementById('tips-container');
        tipsContainer.innerHTML = ''; 
        let tips = [];

        // 1. Postura
        const firstSkill = skillsArray[0] || "";
        if (firstSkill.includes("Comunica√ß√£o")) {
            tips.push("üó£Ô∏è <strong>Comunica√ß√£o:</strong> Mantenha seu gestor informado. Se tiver d√∫vidas, pergunte!");
        } else if (firstSkill.includes("Pontualidade")) {
            tips.push("‚è∞ <strong>Pontualidade:</strong> Isso √© ouro! Mostra que voc√™ leva o contrato a s√©rio.");
        } else if (firstSkill.includes("Proatividade")) {
            tips.push("‚ö° <strong>Proatividade:</strong> Terminou suas tarefas? Pergunte √† equipe: 'Em que mais posso ajudar?'.");
        } else {
            tips.push("ü§ù <strong>Relacionamento:</strong> Cumprimente a todos e seja gentil, o clima agradece!");
        }

        // 2. Marca Pessoal
        const brandTips = [
            "üïµÔ∏è <strong>Sua Marca:</strong> Voc√™ est√° sendo observado positivamente. Sua postura di√°ria constr√≥i sua reputa√ß√£o.",
            "üì± <strong>Celular:</strong> Evite uso excessivo de redes sociais durante o expediente.",
            "üßº <strong>Visual:</strong> Tente seguir o padr√£o de vestimenta da empresa (dress code)."
        ];
        tips.push(brandTips[Math.floor(Math.random() * brandTips.length)]);

        // 3. Networking/Atitude
        if (objectiveType === 'efetivacao') {
             tips.push("üíº <strong>Efetiva√ß√£o:</strong> Mostre interesse pelo neg√≥cio da empresa.");
        } else {
             tips.push("üå± <strong>Conex√µes:</strong> Converse com pessoas de outras √°reas no caf√© ou almo√ßo.");
        }

        tips.forEach(tip => {
            const div = document.createElement('div');
            div.style.marginBottom = "8px";
            div.style.display = "flex";
            div.style.gap = "10px";
            div.style.fontSize = "0.95rem";
            div.innerHTML = `<span style="color: #f1c40f;">‚ú®</span><span>${tip}</span>`;
            tipsContainer.appendChild(div);
        });
    }

    function downloadCard() {
        const card = document.getElementById('final-card');
        
        // Usar html2canvas
        html2canvas(card, {
            scale: 2, 
            backgroundColor: "#ffffff"
        }).then(canvas => {
            const link = document.createElement('a');
            link.download = 'meu-portfolio-card.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    // Inicializa√ß√£o
    loadState();
    updateUI();
</script>

</body>
</html>